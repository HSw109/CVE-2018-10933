import argparse
import socket
from sys import exit

parser = argparse.ArgumentParser(description='check vulnerable libSSH')
parser.add_argument('-t', '--target', help='Specify target')
parser.add_argument('-p', '--port', type=int, help='Specify port')

args = parser.parse_args()

def test(target, port):
    try:
        sock = socket.create_connection((target, port))
        recv = sock.recv(1024)
        sock.close()
    except sock.gaierror:
        parser.print_help()
        exit(1)
    return recv

def main():
    try:
        target = args.target
        port = args.port
    except:
        parser.print_help()
        exit(1)
    receive = test(target=target, port=port)
    if receive:
        print(f'[*] Successful, got message: {receive}')
    
if __name__ =='__main__':
    exit(main())
